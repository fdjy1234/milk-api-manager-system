# 🥛 Milk API Manager System - 操作手冊 (MVP v1.0)

## 1. 系統簡介
本系統是基於 **Apache APISIX** 構建的企業級 API 管理平台，整合了 **AI 驅動的自動化機制**、**動態安全策略**與**全方位監控流水線**。

---

## 2. 環境啟動指南 (Windows 11)

### 前提條件
*   **Docker Desktop**: 已安裝並啟動。
*   **Git**: 用於同步代碼。
*   **.NET 8 SDK**: 用於執行後端與 UI。

### 啟動步驟
1.  開啟 PowerShell 並進入專案目錄。
2.  執行：`.\start-all.bat`。
3.  系統將自動啟動 9 個容器服務，並啟動兩個 .NET 服務。

---

## 3. 核心功能操作

### A. IP 黑名單管理 (Traffic Blocker)
*   **路徑**: 瀏覽器訪問 `http://localhost:5000/blacklist`
*   **操作**: 
    1. 在輸入框輸入要阻斷的 IP（例如 `127.0.0.1` 進行本地測試）。
    2. 點擊 "Add to Blacklist"。
*   **驗證**: 嘗試訪問 `http://localhost:9080`，系統應回傳 **403 Forbidden**。

### B. API 治理與路由清單
*   **路徑**: 瀏覽器訪問 `http://localhost:5000/apis`
*   **功能**: 查看目前網關託管的所有 API 路由、對應路徑及風險等級 (L1-L3)。

### C. API 密鑰自動化輪轉 (Secret Rotation)
*   **後端集成**: 系統已與 HashiCorp Vault 整合。
*   **操作**: 輪轉任務目前由 `SecurityAutomationService` 根據合規週期自動執行，亦可透過 API 手動觸發。

---

## 4. 監控與觀測系統 (Observability)

| 服務 | 訪問路徑 | 用途 |
| :--- | :--- | :--- |
| **Milk Admin UI** | `http://localhost:5000` | 核心管理後台 |
| **Grafana** | `http://localhost:3000` | 即時流量與阻斷數據可視化 |
| **Kibana** | `http://localhost:5601` | 稽核日誌 (Audit Log) 深度查詢 |
| **APISIX Dashboard** | `http://localhost:9000` | 網關原生配置介面 |
| **Jaeger** | `http://localhost:16686` | 分散式鏈路追蹤 (Tracing) |

---

## 5. 常見問題排除 (Troubleshooting)

*   **容器啟動失敗**: 請執行 `docker-compose logs -f` 查看錯誤日誌。
*   **etcd 連線問題**: 確保您的 Windows 防火牆未阻擋 2379 端口。
*   **網關未更新**: 點擊 Admin UI 的同步按鈕或手動重啟 APISIX 容器。

---
*Generated by Milk AI Assistant on 2026-02-10*
